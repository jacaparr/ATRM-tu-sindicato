<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calculadora de Jubilaci√≥n - ATRM</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#FF6B35">
  <style>
    :root{ --primary:#FF6B35; --secondary:#FF8C42; --accent:#FFA726; --dark:#2C3E50; --light:#FFFFFF; --green:#27ae60; --blue:#2980b9; }
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,'Helvetica Neue',Arial;color:var(--dark);background:linear-gradient(180deg,#fff 0%,#fff7f0 100%)}
    .container{max-width:900px;margin:0 auto;padding:20px}
    .page-title{background:linear-gradient(90deg,var(--primary),var(--secondary));color:#fff;padding:22px;text-align:center}
    .page-title h1{font-size:28px}
    .page-title p{opacity:.9;margin-top:4px;font-size:14px}
    .card{background:#fff;border:1px solid #ffe2cf;border-radius:18px;box-shadow:0 10px 24px rgba(255,119,51,.08);padding:24px;margin-bottom:20px}
    .card h2{color:var(--primary);margin-bottom:16px;font-size:20px}
    .form-group{margin-bottom:16px}
    .form-group label{display:block;font-weight:700;margin-bottom:6px;font-size:14px;color:#555}
    .form-group select,.form-group input{width:100%;padding:12px;border:2px solid #ffe2cf;border-radius:12px;font-size:15px;transition:.2s;font-family:inherit}
    .form-group select:focus,.form-group input:focus{outline:none;border-color:var(--primary);box-shadow:0 0 0 3px rgba(255,107,53,.15)}
    .form-row{display:grid;grid-template-columns:1fr 1fr;gap:16px}
    .btn{background:linear-gradient(90deg,var(--primary),var(--secondary));border:none;color:#fff;padding:14px 24px;border-radius:12px;cursor:pointer;font-weight:700;font-size:16px;width:100%;transition:.2s;font-family:inherit}
    .btn:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(255,107,53,.3)}
    .btn.alt{background:#fff;color:var(--primary);border:2px solid var(--primary)}
    .result-panel{display:none}
    .result-panel.show{display:block}
    .result-big{text-align:center;padding:24px;background:linear-gradient(135deg,#e8f5e8,#d4edda);border-radius:16px;margin:16px 0}
    .result-big .age{font-size:48px;font-weight:900;color:var(--green);line-height:1.2}
    .result-big .label{font-size:14px;color:#666;margin-top:4px}
    .result-big .date{font-size:20px;font-weight:700;color:var(--dark);margin-top:8px}
    .detail-grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px;margin:16px 0}
    .detail-item{background:#f8f4f0;padding:14px;border-radius:12px;text-align:center}
    .detail-item .val{font-size:20px;font-weight:800;color:var(--dark)}
    .detail-item .lbl{font-size:11px;color:#888;margin-top:2px}
    .option-card{padding:16px;border:2px solid #e0e0e0;border-radius:14px;margin:10px 0;transition:.2s}
    .option-card.best{border-color:var(--green);background:#f0faf0}
    .option-card.partial{border-color:var(--accent);background:#fff8f0}
    .option-card h3{font-size:16px;margin-bottom:4px}
    .option-card p{font-size:13px;color:#666}
    .option-card .pension{font-size:20px;font-weight:800;color:var(--primary)}
    .info-box{background:linear-gradient(90deg,#fff3e7,#ffe2cf);border-left:4px solid var(--accent);padding:14px;margin:12px 0;border-radius:8px;font-size:14px;line-height:1.6}
    .progress-bar{height:20px;background:#f0e0d6;border-radius:10px;overflow:hidden;margin:8px 0}
    .progress-fill{height:100%;background:linear-gradient(90deg,var(--green),#2ecc71);border-radius:10px;transition:width .5s;display:flex;align-items:center;justify-content:center;font-size:11px;font-weight:700;color:#fff}
    .actions{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:16px}
    .actions .btn{width:auto;font-size:14px;padding:10px 16px}
    @media(max-width:600px){.form-row{grid-template-columns:1fr}.detail-grid{grid-template-columns:1fr 1fr}.result-big .age{font-size:36px}}
  </style>
</head>
<body>
  <link rel="stylesheet" href="css/nav.css">
  <header class="premium-header">
    <div class="header-content">
      <a href="index.html" class="logo">üî• ATRM ¬∑ Tu Sindicato</a>
      <button class="menu-toggle" onclick="document.querySelector('.menu').classList.toggle('open')" aria-label="Men√∫">‚ò∞</button>
      <nav class="menu">
        <a href="index.html">Inicio</a>
        <a href="index.html#convenio">Viaria</a>
        <a href="interiores.html">Interiores</a>
        <a href="salaries.html">Salarios</a>
        <a href="conceptos_2026.html">Conceptos 2026</a>
        <a href="tramites.html">Tr√°mites</a>
        <a href="festivos.html">Festivos</a>
        <a href="generador.html">üìù Docs</a>
        <a href="podcasts.html">üéôÔ∏è Podcasts</a>
        <a href="parentesco.html">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Parentesco</a>
        <a href="verificador-nomina.html">üßæ N√≥mina</a>
        <a href="calculadora-despido.html">üìä Despido</a>
        <a href="calculadora-jubilacion.html">üèñÔ∏è Jubilaci√≥n</a>
        <a href="actas-transparencia.html">üìã Transparencia</a>
        <a href="calendario-laboral.html">üìÖ Calendario</a>
        <a href="index.html#contacto">Contacto</a>
      </nav>
    </div>
  </header>

  <header class="page-title">
    <h1>üèñÔ∏è CALCULADORA DE JUBILACI√ìN</h1>
    <p>Descubre cu√°ndo puedes jubilarte y con qu√© porcentaje</p>
  </header>

  <div class="container">
    <div class="actions">
      <a class="btn alt" href="index.html">‚Üê Volver</a>
      <a class="btn alt" href="verificador-nomina.html">üßæ Verificar N√≥mina</a>
      <a class="btn alt" href="calculadora-despido.html">üìä Indemnizaci√≥n</a>
    </div>

    <div class="card">
      <h2>üìã Tus datos</h2>
      <div class="form-row">
        <div class="form-group">
          <label>Fecha de nacimiento</label>
          <input type="date" id="fechaNacimiento">
        </div>
        <div class="form-group">
          <label>A√±os cotizados a la Seguridad Social</label>
          <input type="number" id="aniosCotizados" min="0" max="50" placeholder="Ej: 25">
        </div>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label>Base reguladora mensual estimada (‚Ç¨)</label>
          <input type="number" id="baseReguladora" step="0.01" placeholder="Ej: 1500 (media de tus √∫ltimas bases)">
        </div>
        <div class="form-group">
          <label>¬øSigues cotizando?</label>
          <select id="sigueCotizando">
            <option value="si">S√≠, sigo trabajando</option>
            <option value="no">No, actualmente no cotizo</option>
          </select>
        </div>
      </div>
    </div>

    <button class="btn" onclick="calcularJubilacion()">üèñÔ∏è CALCULAR JUBILACI√ìN</button>

    <div id="resultado" class="result-panel">
      <div class="card">
        <h2>üìä Tu jubilaci√≥n</h2>
        <div class="result-big">
          <div class="age" id="resEdad">65</div>
          <div class="label">Edad ordinaria de jubilaci√≥n</div>
          <div class="date" id="resFecha">--</div>
        </div>
        <div class="detail-grid">
          <div class="detail-item">
            <div class="val" id="resEdadActual">--</div>
            <div class="lbl">Tu edad actual</div>
          </div>
          <div class="detail-item">
            <div class="val" id="resFaltan">--</div>
            <div class="lbl">A√±os que te faltan</div>
          </div>
          <div class="detail-item">
            <div class="val" id="resPorcentaje">--</div>
            <div class="lbl">% de la base reguladora</div>
          </div>
        </div>

        <h3 style="margin:16px 0 8px;color:var(--primary)">üìä Progreso de cotizaci√≥n</h3>
        <div class="progress-bar">
          <div class="progress-fill" id="progressBar" style="width:0%">0%</div>
        </div>
        <p style="font-size:12px;color:#888;text-align:center" id="progressText">-- de 36 a√±os y 6 meses para el 100%</p>

        <div id="opcionesJubilacion"></div>
        
        <div id="pensionEstimada" class="info-box" style="display:none"></div>
      </div>
    </div>

    <div class="card">
      <h2>üìö Informaci√≥n sobre jubilaci√≥n (2026)</h2>
      <div class="info-box">
        <strong>Edad ordinaria 2026:</strong><br>
        ‚Ä¢ Con <strong>38 a√±os y 3 meses o m√°s</strong> cotizados ‚Üí jubilaci√≥n a los <strong>65 a√±os</strong><br>
        ‚Ä¢ Con menos ‚Üí jubilaci√≥n a los <strong>66 a√±os y 8 meses</strong><br><br>
        <strong>Jubilaci√≥n anticipada voluntaria:</strong> m√°ximo 2 a√±os antes de la edad ordinaria, pero con penalizaci√≥n de entre 2,81% y 21% seg√∫n trimestres de anticipo y a√±os cotizados.<br><br>
        <strong>Jubilaci√≥n anticipada involuntaria</strong> (despido, ERE): m√°ximo 4 a√±os antes, con penalizaciones menores.<br><br>
        <strong>Porcentaje de la pensi√≥n:</strong><br>
        ‚Ä¢ 15 primeros a√±os cotizados ‚Üí 50%<br>
        ‚Ä¢ Del a√±o 16 al 25 ‚Üí +0,21% por mes (2,52%/a√±o)<br>
        ‚Ä¢ Del a√±o 25 al 36,5 ‚Üí +0,19% por mes (2,28%/a√±o)<br>
        ‚Ä¢ Con 36 a√±os y 6 meses ‚Üí 100%<br><br>
        <strong>Periodo de c√°lculo 2026:</strong> Media de las bases de cotizaci√≥n de los √∫ltimos <strong>25 a√±os</strong> (300 meses).
      </div>
    </div>
  </div>

  <link rel="stylesheet" href="css/bottom-nav.css">
  <nav class="bottom-nav">
    <a href="index.html" class="bottom-nav-item"><span class="bottom-nav-icon">üè†</span><span>Inicio</span></a>
    <a href="salaries.html" class="bottom-nav-item"><span class="bottom-nav-icon">üí∞</span><span>Salarios</span></a>
    <a href="noticias.html" class="bottom-nav-item"><span class="bottom-nav-icon">üì∞</span><span>Noticias</span></a>
    <a href="tramites.html" class="bottom-nav-item"><span class="bottom-nav-icon">üìã</span><span>Tr√°mites</span></a>
    <a href="index.html#contacto" class="bottom-nav-item"><span class="bottom-nav-icon">üìû</span><span>Contacto</span></a>
  </nav>

<script>
function calcularJubilacion() {
  const fechaNac = document.getElementById('fechaNacimiento').value;
  const aniosCotizados = parseInt(document.getElementById('aniosCotizados').value) || 0;
  const baseReg = parseFloat(document.getElementById('baseReguladora').value) || 0;
  const sigueCotizando = document.getElementById('sigueCotizando').value === 'si';

  if (!fechaNac) { alert('Introduce tu fecha de nacimiento'); return; }

  const hoy = new Date();
  const nacimiento = new Date(fechaNac);
  const edadActual = (hoy - nacimiento) / (1000 * 60 * 60 * 24 * 365.25);

  // Edad ordinaria 2026: 65 con 38a3m+ cotizados, sino 66a8m
  let edadOrdinaria, edadOrdAnios, edadOrdMeses;
  if (aniosCotizados >= 38) {
    edadOrdinaria = 65;
    edadOrdAnios = 65;
    edadOrdMeses = 0;
  } else {
    edadOrdinaria = 66 + 8/12;
    edadOrdAnios = 66;
    edadOrdMeses = 8;
  }

  // Fecha jubilaci√≥n
  const fechaJub = new Date(nacimiento);
  fechaJub.setFullYear(fechaJub.getFullYear() + edadOrdAnios);
  fechaJub.setMonth(fechaJub.getMonth() + edadOrdMeses);

  const faltanAnios = Math.max(0, Math.ceil((fechaJub - hoy) / (1000 * 60 * 60 * 24 * 365.25) * 10) / 10);

  // Porcentaje de pensi√≥n seg√∫n a√±os cotizados
  // A√±os que tendr√° cuando se jubile
  const aniosCotFuturos = sigueCotizando ? aniosCotizados + Math.max(0, Math.ceil(faltanAnios)) : aniosCotizados;
  const porcentaje = calcularPorcentaje(aniosCotFuturos);

  // Progreso
  const progreso = Math.min(100, (aniosCotFuturos / 36.5) * 100);

  // Display
  document.getElementById('resEdad').textContent = edadOrdMeses > 0 ? `${edadOrdAnios} a√±os y ${edadOrdMeses} meses` : `${edadOrdAnios} a√±os`;
  document.getElementById('resFecha').textContent = fechaJub.toLocaleDateString('es-ES', {day: 'numeric', month: 'long', year: 'numeric'});
  document.getElementById('resEdadActual').textContent = Math.floor(edadActual) + ' a√±os';
  document.getElementById('resFaltan').textContent = faltanAnios <= 0 ? '¬°Ya puedes!' : faltanAnios.toFixed(1) + ' a√±os';
  document.getElementById('resPorcentaje').textContent = porcentaje.toFixed(1) + '%';

  document.getElementById('progressBar').style.width = progreso.toFixed(0) + '%';
  document.getElementById('progressBar').textContent = progreso.toFixed(0) + '%';
  document.getElementById('progressText').textContent = `${aniosCotFuturos} a√±os cotizados${sigueCotizando ? ' (estimados al jubilarte)' : ''} de 36,5 necesarios para el 100%`;

  // Opciones
  let html = '<h3 style="margin:16px 0 8px;color:var(--primary)">üóìÔ∏è Opciones de jubilaci√≥n</h3>';

  // Ordinaria
  html += `<div class="option-card best">
    <h3>‚úÖ Jubilaci√≥n ordinaria</h3>
    <p>A los ${edadOrdAnios} a√±os${edadOrdMeses ? ' y ' + edadOrdMeses + ' meses' : ''} ‚Äî ${fechaJub.toLocaleDateString('es-ES')}</p>
    <div class="pension">${porcentaje.toFixed(1)}% de la base reguladora</div>
  </div>`;

  // Anticipada voluntaria (2 a√±os antes)
  if (aniosCotFuturos >= 35) {
    const fechaAntVol = new Date(fechaJub);
    fechaAntVol.setFullYear(fechaAntVol.getFullYear() - 2);
    const penalizacionVol = calcPenalizacionVoluntaria(8, aniosCotFuturos); // 8 trimestres = 2 a√±os
    html += `<div class="option-card partial">
      <h3>‚è© Anticipada voluntaria (2 a√±os antes)</h3>
      <p>A partir de ${fechaAntVol.toLocaleDateString('es-ES')} ‚Äî Requiere min. 35 a√±os cotizados</p>
      <div class="pension">${(porcentaje * (1 - penalizacionVol / 100)).toFixed(1)}% (penalizaci√≥n: -${penalizacionVol.toFixed(1)}%)</div>
    </div>`;
  }

  // Anticipada involuntaria (4 a√±os antes)
  if (aniosCotFuturos >= 33) {
    const fechaAntInv = new Date(fechaJub);
    fechaAntInv.setFullYear(fechaAntInv.getFullYear() - 4);
    const penalizacionInv = calcPenalizacionInvoluntaria(16, aniosCotFuturos);
    html += `<div class="option-card partial">
      <h3>üìã Anticipada involuntaria (4 a√±os antes)</h3>
      <p>A partir de ${fechaAntInv.toLocaleDateString('es-ES')} ‚Äî Despido, ERE, etc. Min. 33 a√±os cotizados</p>
      <div class="pension">${(porcentaje * (1 - penalizacionInv / 100)).toFixed(1)}% (penalizaci√≥n: -${penalizacionInv.toFixed(1)}%)</div>
    </div>`;
  }

  document.getElementById('opcionesJubilacion').innerHTML = html;

  // Pensi√≥n estimada
  if (baseReg > 0) {
    const pensionBruta = baseReg * (porcentaje / 100);
    const pensionMax2026 = 3267.60; // tope 2026 estimado
    const pensionFinal = Math.min(pensionBruta, pensionMax2026);
    document.getElementById('pensionEstimada').style.display = 'block';
    document.getElementById('pensionEstimada').innerHTML = `
      <strong>üí∞ Pensi√≥n mensual estimada:</strong><br>
      ‚Ä¢ Base reguladora: ${baseReg.toFixed(2)} ‚Ç¨/mes<br>
      ‚Ä¢ Porcentaje aplicable: ${porcentaje.toFixed(1)}%<br>
      ‚Ä¢ <strong>Pensi√≥n bruta: ${pensionBruta.toFixed(2)} ‚Ç¨/mes</strong> (${(pensionBruta * 14).toFixed(2)} ‚Ç¨/a√±o con 14 pagas)<br>
      ${pensionBruta > pensionMax2026 ? '‚Ä¢ ‚ö†Ô∏è Se aplica pensi√≥n m√°xima: ' + pensionMax2026.toFixed(2) + ' ‚Ç¨/mes' : ''}
      <br><br>‚ö†Ô∏è Este c√°lculo es orientativo. La base reguladora real se calcula con las bases de los √∫ltimos 25 a√±os (300 meses). Consulta tu informe de vida laboral.
    `;
  } else {
    document.getElementById('pensionEstimada').style.display = 'none';
  }

  document.getElementById('resultado').classList.add('show');
  document.getElementById('resultado').scrollIntoView({behavior: 'smooth'});
}

function calcularPorcentaje(anios) {
  if (anios < 15) return 0;
  if (anios === 15) return 50;
  
  let porcentaje = 50;
  const mesesExtra = (anios - 15) * 12;
  
  // Meses 1-120 (a√±os 16-25): 0.21%/mes
  const m1 = Math.min(mesesExtra, 120);
  porcentaje += m1 * 0.21;
  
  // Meses 121-258 (a√±os 25-36.5): 0.19%/mes  
  if (mesesExtra > 120) {
    const m2 = Math.min(mesesExtra - 120, 138);
    porcentaje += m2 * 0.19;
  }
  
  return Math.min(100, porcentaje);
}

function calcPenalizacionVoluntaria(trimestres, aniosCotizados) {
  // Coeficientes por trimestre seg√∫n a√±os cotizados
  if (aniosCotizados >= 44.5) return trimestres * 0.5;
  if (aniosCotizados >= 41.5) return trimestres * 0.56;
  if (aniosCotizados >= 38.5) return trimestres * 0.63;
  return trimestres * 0.81;
}

function calcPenalizacionInvoluntaria(trimestres, aniosCotizados) {
  if (aniosCotizados >= 44.5) return trimestres * 0.5;
  if (aniosCotizados >= 41.5) return trimestres * 0.56;
  if (aniosCotizados >= 38.5) return trimestres * 0.63;
  return trimestres * 0.69;
}
</script>
</body>
</html>
